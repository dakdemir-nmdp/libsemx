# libsemx TODO

## Active
- [ ] Sparse Linear Algebra
    - [x] Replace dense Eigen matrices with Sparse matrices in `CovarianceStructure` interface.
        - [x] Added `is_sparse()` and `materialize_sparse()` to `CovarianceStructure`.
        - [x] Implemented optimized `materialize_sparse()` for `DiagonalCovariance`.
        - [x] Added tests for sparse materialization and fallback.
    - [x] Update `LikelihoodDriver` to utilize sparse matrices for large-scale operations.
        - [x] Implemented `solve_laplace_system_sparse` using `Eigen::SimplicialLDLT`.
        - [x] Implemented `compute_system_grad_hess_sparse` for efficient gradient/Hessian assembly.
        - [x] Added `sparse_likelihood_tests.cpp` to validate sparse solver correctness.
    - [x] Implement sparse `KroneckerCovariance`.
        - [x] Implemented `is_sparse()` and `materialize_sparse()` using sparse Kronecker product.
        - [x] Implemented `parameter_gradients_sparse()` for efficient gradient computation.
        - [x] Added tests for sparse Kronecker materialization and gradients.
- [x] Implement Genomic Selection (GBLUP) in R package.
    - [x] Created `semx_gs` function in R package.
    - [x] Fixed REML bug where latent random effects were incorrectly treated as fixed effects.
    - [x] Fixed Rcpp bindings for `grm_vanraden` and `grm_kronecker` to return matrices instead of vectors.
    - [x] Fixed `semx_variance_components` to correctly report GBLUP variances (handle scalar design with matrix covariance).
    - [x] Verified with `check_gs.R`.
- [x] Fix "Zero-BLUP" regression in R package.
    - [x] Fixed graph construction where random effect edges were not being registered in the `ModelGraph`, causing them to be ignored during optimization and BLUP calculation.
    - [x] Verified fix with `check_ranef.R` using both manual model construction and string parser.
- [x] Fix Documentation Examples
    - [x] Fix `docs/examples/mdp_analysis.Rmd` rendering issue (convert grouping variable to numeric).
- [x] Validation & Benchmarking against established software.
    - [x] Create Python notebook comparing `libsemx` GLMM results with `statsmodels`/`lme4`.
    - [x] Create R notebook comparing `libsemx` SEM/GLMM results with `lavaan`/`lme4`.
        - [x] Implemented `ExplicitCovariance` to support standard SEM parameterization (elements of $\Sigma$).
        - [x] Debug segfault in R validation script (Fixed: `ModelObjective` now correctly handles gradient vector resizing on exception).
        - [x] Align C++ core results with `lme4` for `sleepstudy` dataset (Fixed: Dispersion parameter estimation in non-SEM mode).
            - [x] Fixed regression in Sleepstudy test (2025-02-24).
        - [x] Validate AIC, BIC, LogLik against `lme4`.
        - [x] Create Binomial GLMM comparison (binary outcome) against `lme4::glmer`.
        - [x] Validate Random Effects (BLUPs) against `lme4`.
        - [x] Create SEM comparison against `lavaan` (Growth Curve or CFA).
            - [x] Implemented CFA comparison using BFI dataset.
            - [x] Investigate BFI CFA convergence failure (LBFGS Line Search Error).
                - [x] Fixed gradient mismatch by adding missing Hessian derivative term for dispersion parameters in Laplace approximation path.
            - [x] Validated LogLik against `lavaan` (Fit indices currently disabled due to missing baseline model).
            - [x] Fixed SRMR calculation by converting Cholesky parameters back to Covariance parameters in `ModelObjective`.
            - [x] Addressed convergence issues by relaxing tolerance and using Release build.
            - [x] Fix performance regression in BFI CFA test (Decoupled gradient computation).
        - [x] Comprehensive validation of covariance structures (Random Intercept, Random Slope) against `lme4`.
        - [x] Fix `ModelObjective` to correctly handle fixed covariance parameters (e.g. fixed residual variance) by parsing numeric parameter IDs.
        - [x] Create GBLUP/GxE comparison against `sommer` (Coefficients, BLUPs, Fit Indices).
            - [x] Implemented GBLUP and GxE tests in `cpp/tests/sommer_comparison_tests_v2.cpp`.
            - [x] GxE results match `sommer` closely.
            - [x] Investigate GBLUP variance inflation (factor ~3.2) in `libsemx` vs `sommer` expectation. (Resolved: `libsemx` finds better NLL; discrepancy likely due to external model definition).
    - [x] Create comparison for survival outcomes (vs `survival`/`coxme`).
        - [x] Implemented Weibull and Exponential survival comparison against `survival::survreg` using Ovarian dataset.
        - [x] Fixed `WeibullOutcome` gradient (added `d_dispersion`) to ensure convergence.
        - [x] Validated LogLik, Coefficients, and Shape/Scale parameters.
        - [x] Fixed initialization of Weibull shape parameter to avoid numerical instability (2025-02-24).
        - [x] Fixed implicit intercept handling in R frontend to match `survreg` behavior (2025-02-24).
    - [x] Phase 2: Exhaustive validation grid (ML/REML) vs `lm`/`glm`/`lme4`/`nlme`/`sommer`.
        - [x] Add simulated and empirical LM/GLM/GLMM fixtures (binomial/poisson/NB) with and without random effects; compare coefficients, dispersions, and log-likelihoods to `glm`/`glmer`.
            - [x] Created `validation/validate_glm_families.R` to compare Binomial, Poisson, Negative Binomial, and Binomial GLMM.
            - [x] Validated LogLik and Coefficients against `glm`, `MASS::glm.nb`, and `lme4::glmer`.
            - [x] Confirmed `libsemx` matches standard R implementations for these families.
        - [x] Cross-check AR(1) and CS covariance parameters against `nlme` (corStruct) and `gls`.
        - [x] Cross-check Toeplitz covariance parameters against simulation.
        - [x] Cross-check factor-analytic covariance parameters against simulation.
        - [x] Validate ML vs REML parity for Gaussian LMMs across `lme4`, `nlme`, and `libsemx` (fixed-only, random-only, and mixed models).
        - [x] Expand multi-outcome/mixed-type coverage (Gaussian/Binomial/Poisson/Ordinal) with and without SEM structure; compare to `lavaan` for SEM cases and `nlme`/`lme4` for mixed cases.
            - [x] Fixed Joint Independent GLMM optimization (Gaussian+Binomial+Poisson) by explicit RE-Outcome linking and preventing SEM mode trigger (2025-02-24).
            - [x] Implemented Ordinal Regression support (Probit link) and validated against `MASS::polr` (2025-02-24).
            - [x] Fixed zero-convergence of factor loadings in mixed models by implementing gradients for design matrix parameters in `LikelihoodDriver`.
            - [x] Validated Joint Independent GLMM (Gaussian+Binomial+Poisson) against `lme4` (sum of independent log-likelihoods).
            - [x] Validate Mixed Path Analysis (e.g. Mediation: X -> M -> Y) with Random Effects against `lme4` (stepwise).
                - [x] Created `validation/validate_mixed_sem.R`.
                - [x] Validated parameters and LogLik for Gaussian Mediator + Binomial Outcome with Random Intercepts.
            - [x] Validate Latent Growth Curve Model against `lavaan`.
                - [x] Fixed latent mean estimation (intercepts) by correctly mapping `_intercept -> latent` edges to fixed effects on loading vectors.
            - [x] Validate Ordinal CFA against `lavaan` (ML/Integration).
            - [x] Validate Mixed CFA (Continuous + Ordinal indicators) against `lavaan`.
        - [x] Broaden genomic selection checks (GBLUP, RKHS/multi-kernel, G×E) against `sommer`, using simulated truth and precomputed kernels to validate variance components and BLUPs. (2025-02-24)
            - [x] Validated single-kernel GBLUP against `sommer` (exact match).
            - [x] GxE/Repeated Records support requires Z-matrix construction from factor variables.
                - [x] Implemented automatic factor expansion (dummy coding) in Python `Model.fit`.
                - [x] Implemented automatic factor expansion in R `semx_fit`.
                - [x] Verified with reproduction scripts for both languages.
        - [x] Add simulation harness that asserts recovery of known parameters (do not rely solely on comparator software correctness); report tolerance bands and any systematic drifts.
            - [x] Created `validation/simulation_harness.R` covering Gaussian, Mixed, Binomial/Poisson GLMM, CFA, and Survival models.
            - [x] Verified parameter recovery within tolerance (GLMM variances required relaxed tolerance due to Laplace approximation bias).

## Phase 3: Advanced Features & Optimization
- [x] **Multi-group Analysis** (Blueprint §2.2)
    - [x] Extend `ModelGraph`/`ModelIR` to support multiple groups (multiple data blocks, parameter constraints across groups).
    - [x] Update `LikelihoodDriver` to sum log-likelihoods across groups.
    - [x] Update front-ends (R/Python) to accept `group` argument and `group.equal` constraints.
- [x] **Sparse Linear Algebra** (Blueprint §2.6, §12)
    - [x] Replace dense Eigen matrices with Sparse matrices in `CovarianceStructure` and `LikelihoodDriver` where appropriate (e.g. large GRMs, sparse design matrices).
    - [x] Implement sparse Cholesky solver for Laplace approximation.
        - [x] Implemented `Eigen::SimplicialLDLT` solver for sparse Hessian inversion.
        - [x] Optimized sparse Hessian assembly using `SparseHessianAccumulator` to cache sparsity patterns (3x speedup in assembly).
- [x] **Advanced Visualization** (Blueprint §8.1, §9.1)
    - [x] Implement Path Diagrams (using `DiagrammeR` in R, `graphviz` in Python).
    - [x] Implement Survival Curves / CIF plots.
    - [x] Implement GxE Reaction Norm plots.
- [x] **High-level Genomic Selection API** (Blueprint §4.6, §4.7)
    - [x] Implement `semx_gs` in R (matching blueprint syntax).
    - [x] Enhance `semx.gxe_model` in Python to support Kronecker structures ($K_G \otimes I_E$).
    - [x] Add `semx_gxe` in R (wrapper for GxE models).
        - [x] Implemented `semx_gxe` with support for diagonal and Kronecker covariance structures.
        - [x] Updated C++ core and bindings to support composite covariances (passing component IDs).
        - [x] Verified with `test-gxe.R` and `test-gs.R`.

## Completed
- [x] Align R bindings with Python (variance components, covariance weights, Q-Q plots). (2025-12-07)
    - [x] Implemented `semx_variance_components` and `semx_covariance_weights` in R.
    - [x] Updated `summary.semx_fit` and `print.summary.semx_fit` to display these components.
    - [x] Updated `plot.semx_fit` to support Q-Q plots (`type="qq"`).
    - [x] Verified with `Rpkg/semx/tests/testthat/test-summary-enhancements.R`.
- [x] Fix crash in `validation/comparison.Rmd` by defaulting unstructured covariance diagonal to 1.0 when unspecified. (2025-02-24)
- [x] Fix `ModelObjective` initialization to respect `status` map for covariance parameters. (2025-02-24)
- [x] Extend SEM branch to honor full structural model. (2025-12-02)
    - [x] Propagate regression edges into `_stacked_y` predictors.
    - [x] Carry intercepts/means.
    - [x] Map cross-latent and residual covariances (Latents grouped with Unstructured covariance).
- [x] Implement dispersion/threshold parameter handling for non-Gaussian GLMMs. (2025-12-02)
    - [x] Expose parameters in catalog.
    - [x] Implement gradients.
- [x] Plumb `EstimationMethod` (ML/REML) through `ModelObjective`. (2025-12-02)
    - [x] Updated `ModelObjective` and `LikelihoodDriver::fit` to accept `EstimationMethod`.
    - [x] Implemented REML logic for Gaussian fixed-effects models in `LikelihoodDriver`.
    - [x] Verified with `reml_plumbing_tests.cpp`.
- [x] Harden Laplace solver (damping, line search, diagnostics). (2025-12-02)
    - [x] Implemented backtracking line search in `solve_laplace_system`.
    - [x] Added Cholesky damping to handle non-positive definite Hessians.
- [x] Polish Python/R `summary()`/`predict()`/`plot()` surfaces. (2025-12-02)
    - [x] Updated Python `SemFit.summary()` to return structured `SemFitSummary` object.
    - [x] Enhanced Python `SemFit.plot()` with `ax` support and Q-Q plots.
    - [x] Improved R `summary.semx_fit` to return list with fit indices and parameter table.
    - [x] Updated R `plot.semx_fit` to accept additional arguments.
- [x] Add identifiability checks/constraints for composed covariances (Kronecker scaling, Hadamard or weighted sums with weights summing to 1). (2025-12-02)
    - [x] Implemented analytic gradients for `KroneckerCovariance` with `learn_scale=true`.
    - [x] Added `simplex_weights` mode to `MultiKernelCovariance` with softmax transform and gradients.
- [x] Align front-end APIs with the richer DSL/plotting guidelines and design identifiability checks plus summary reporting plan. (2025-02-24)
    - [x] Updated `Model` (Python) to support `multi_kernel_simplex` and list of marker matrices.
    - [x] Updated `SemFitSummary` (Python) to display covariance weights and use parameter names from C++.
    - [x] Fixed C++ `build_covariance_positive_mask` for `multi_kernel_simplex`.
    - [x] Exposed `parameter_names` in `FitResult` via bindings.
- [x] Extend optimizers and fit indices. (2025-02-24)
    - [x] Implement CFI, TLI, RMSEA, and SRMR fit indices in C++ and expose to bindings. (2025-02-24)
    - [x] Add variance component extraction methods. (2025-02-24)
    - [x] Explore/expose additional optimizer settings (e.g., line search parameters). (2025-02-24)
- [x] Enrich ModelIR to carry extra schema. (2025-02-24)
    - [x] Extend `ModelIR` to store variable labels, measurement levels, and other metadata.
    - [x] Ensure this metadata is preserved through the bindings and available in `summary()`.

## Completed
- [x] Support precomputed covariance matrices in Python and R front-ends. (2025-02-24)
    - [x] Updated `semx.Model` (Python) to accept `data` in genomic specs.
    - [x] Updated `semx_model` (R) to accept `data` in genomic specs.
    - [x] Updated MDP analysis notebooks to demonstrate usage.
- [x] Add higher-level GS/trait×env builders. (2025-02-24)
    - [x] Create easy-to-use builders for G×E models (e.g., `semx.gxe_model(...)`).
    - [x] Support multi-environment trial (MET) data structures.
- [x] Wire survival status through R fit and add CIF/survival prediction helpers. (2025-12-02)
    - [x] Update R `semx_fit` to handle `Surv()` objects or status columns.
    - [x] Implement `predict_survival()` and `predict_cif()` helpers in R and Python.
- [x] Flesh out R/Python public methods to match blueprint surface. (2025-12-02)
    - [x] Implement `summary()`, `predict()`, and `plot()` methods in Python (`semx.Model`) and R (`semx_model`).
    - [x] Add Genomic Selection (GS) utilities (e.g., cross-validation helpers, heritability extraction).
- [x] Implement Mixed Model syntax parser in R front-end. (2025-02-24)
    - [x] Support `(1 | group)` and `(slope | group)` syntax in equations.
    - [x] Map these expressions to `ModelIR` random effects structure.
    - [x] Ensure parity with Python implementation.
- [x] Implement Mixed Model syntax parser in Python front-end. (2025-02-24)
    - [x] Support `(1 | group)` and `(slope | group)` syntax in equations.
    - [x] Map these expressions to `ModelIR` random effects structure.
    - [x] Automatically inject `_intercept` column for random slopes with intercept.
- [x] Implement Survival Analysis syntax in Python front-end. (2025-02-24)
    - [x] Support `Surv(time, status) ~ predictors` syntax in `python/semx/model.py`.
    - [x] Automatically register `status` variable and map to `LikelihoodDriver` inputs.
    - [x] Ensure `OutcomeFamily` is correctly set (Weibull, Exponential, etc.) via user input and C++ plumbing.
- [x] Implement analytic gradients for residual variances in SEM mode. (2025-02-24)
    - [x] Extended `LikelihoodDriver` to compute gradients w.r.t. dispersions using `dispersion_param_mappings`.
    - [x] Updated `ModelObjective` to use analytic gradients for residual variances, removing the finite difference fallback.
    - [x] Verified with `cpp/tests/sem_gradient_tests.cpp`.
- [x] Optimize SEM gradients (Analytic Gradients for Loadings). (2025-02-24)
    - [x] Implemented `evaluate_model_gradient` support for `data_param_mappings` to compute gradients w.r.t. design matrix $Z$.
    - [x] Updated `ModelObjective` to use analytic gradients for loadings and covariance parameters.
    - [x] Verified with `cpp/tests/sem_gradient_tests.cpp` matching FD gradients.
- [x] Expose post-estimation diagnostics to R bindings. (2025-02-24)
    - [x] Added R bindings for `compute_standardized_estimates`, `compute_model_diagnostics`, `compute_modification_indices`.
    - [x] Updated `semx_model` (R) to provide methods/accessors for these diagnostics.
    - [x] Fixed `compute_modification_indices` to include diagonal elements (variances) as candidates.
- [x] Fix LikelihoodDriver for SEM estimation (Latent Variables). (2025-02-24)
- [x] Build genomic kernel stack and GRM ingestion (blueprint §§3.4–5).
    - [x] Add `GenomicRelationshipMatrix` (VanRaden) builder plus Kronecker helper for G×E kernels.
    - [x] Wire GRM/`genomic` covariance structure through the factory with positive masks.
    - [x] Add C++ tests covering GRM construction and GRM-powered likelihood evaluation.
    - [x] Extend ModelIR/bindings to ingest marker payloads directly.
    - [x] Add Python/R surfacing for genomic kernels and multi-environment fixtures.

    - [x] Modified `ModelObjective` to handle "SEM mode" by stacking data and dynamically updating design matrices with Loading parameters.
    - [x] Verified with `python/semx/tests/test_sem_estimation.py` (Loadings are now estimated correctly).
- [x] Expose post-estimation diagnostics to Python bindings. (2025-02-24)
    - [x] Add Python bindings for `compute_standardized_estimates`, `compute_model_diagnostics`, `compute_modification_indices`.
    - [x] Update `semx.Model` (Python) to provide methods/accessors for these diagnostics.
- [x] Implement post-estimation diagnostics (blueprint §2.8). (2025-02-24)
	- [x] Implement standardized parameter estimates (std.lv, std.all). (2025-02-24)
	- [x] Implement model-implied covariance/means and residuals. (2025-02-24)
	- [x] Implement modification indices (approximate via gradients). (2025-02-24)
- [x] Refactor LikelihoodDriver to decouple ModelObjective and Covariance Factory. (2025-02-24)
	- [x] Extract `ModelObjective` class to `cpp/src/libsemx/model_objective.cpp` and `cpp/include/libsemx/model_objective.hpp`.
	- [x] Move covariance factory logic (`create_covariance_structure`, `build_covariance_positive_mask`) to `cpp/src/libsemx/covariance_structure.cpp`.
	- [x] Clean up `LikelihoodDriver` to remove duplicate code and unused constants.
- [x] Implement non-Gaussian outcome families (blueprint §2.4). (2025-12-12)
	- [x] Add `BinomialOutcome` (logit/probit), `PoissonOutcome`, `NegativeBinomialOutcome`.
	- [x] Implement Laplace approximation for these families in `LikelihoodDriver`.
	- [x] Add tests for GLMM scenarios.
- [x] Implement Full Information Maximum Likelihood (FIML) for missing data (blueprint §2.6). (2025-12-12)
	- [x] Update `LikelihoodDriver` to handle `NaN` in observed data by filtering indices per row/cluster.
	- [x] Ensure `OutcomeFamily` subclasses handle missingness correctly (usually by just skipping the contribution).
	- [x] Add tests with missing data patterns.
- [x] Implement standard errors and fit statistics for model parameters (blueprint §2.8). (2025-12-12)
	- [x] Add `FitResult` struct to C++ core (replacing or extending `OptimizationResult`) containing parameter estimates, SEs, vcov matrix, and fit indices (AIC, BIC).
	- [x] Implement numerical Hessian computation (finite differences) for the marginal log-likelihood in `LikelihoodDriver` as a post-fit step.
	- [x] Expose `FitResult` to Python and R bindings.
	- [x] Update Python `semx.Model.fit()` and R `semx_model` to return/print summary with SEs and p-values.
	- [x] Add integration tests verifying SEs against known results (e.g., `lme4` or `lavaan` benchmarks).
- [x] Extend ModelGraph + IR parameter registry so structural equations, constraints, and parameter metadata match blueprint §§2.2–3.2. Tests: `ctest --test-dir build -R "model_graph"`, `ctest --test-dir build -R "likelihood_driver"`, `PYTHONPATH=build uv run pytest python/semx/tests -k "model_graph or fit"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Introduce a central parameter catalog that maps edge IDs and covariance specs to `Parameter` objects plus transforms, then thread it through `LikelihoodDriver::fit`.
	- [x] Restore the default identity design fallback for scaled-fixed random effects so the GRM/fixed covariance fixtures keep passing after the catalog refactor. (2025-12-01)
	- [x] Expand `ModelGraph` to store regressions/loadings/covariances directly and serialize them into ModelIR so bindings share one source of truth (parameter specs recorded with constraint metadata surfaced through Python/R bindings). (2025-12-12)
	- [x] Add Catch2 + Python/R tests exercising duplicate detection, parameter ordering, and gradient alignment once the registry is in place. (2025-12-01)
		- [x] Cover ModelGraph duplicate/family validation through `python/semx/tests/test_model_graph.py` so bindings mirror the C++ exceptions. (2025-12-11)
		- [x] Mirror ModelGraph edge/covariance/random-effect serialization plus validation via `python/semx/tests/test_model_graph.py` and `python/semx/tests/test_model_ir.py`. (2025-12-11)
		- [x] Add `testthat` coverage for ModelIRBuilder invariants (duplicates, families, edge/covariance/random-effect checks) in `Rpkg/semx/tests/testthat/test-bindings.R`. (2025-12-11)
		- [x] Extend Catch2 `cpp/tests/model_graph_tests.cpp` with empty-graph, covariance, and edge/random-effect validation cases to keep the core aligned with the bindings. (2025-12-11)
		- [x] Assert deterministic parameter ordering/constraints across C++/Python/R (new Catch2 tests plus `test_model_graph.py` and `test-bindings.R`), and fix the REML adjustment sign in `LikelihoodDriver` while wiring the catalog to the serialized specs. (2025-12-12)
- [x] Broaden the covariance catalog with compound symmetry, AR(1), Toeplitz, and factor-analytic structures per blueprint §3.3, each with analytic gradients. Tests: `ctest --test-dir build -R "covariance"`, `ctest --test-dir build -R "laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k "covariance"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Implement the new covariance classes plus factory wiring and gradient hooks, preserving positive-definite parameterizations.
	- [x] Add finite-difference gradient probes in Catch2 along with Laplace fit scenarios that mix the new structures with existing ones.
	- [x] Mirror the fixtures via Python/R tests that serialize IR payloads using the new covariance identifiers.
- [x] Complete the survival and competing-risks stack by adding exponential, lognormal, and loglogistic AFT outcomes plus CIF-aware cause-specific families (blueprint §7). Tests: `ctest --test-dir build -R "survival"`, `PYTHONPATH=build uv run pytest python/semx/tests -k "survival"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Implement the additional outcome families with analytic derivatives and shared dispersion handling (shared-dispersion broadcast wired through LikelihoodDriver helpers).
	- [x] Extend `LikelihoodDriver::evaluate_model_loglik_full` scenarios (C++/Python/R) to cover censored data and CIF calculations; add analytic helper assertions plus R bindings tests mirroring the C++/Python fixtures. (2025-12-01)
	- [x] Document the new families in README/examples and add deterministic fixtures for multi-cause survival payloads (`python/README.md`, `docs/examples/survival_cif.md`). (2025-12-01)
	- [x] Ensure the survival unit/integration tests participate in `ctest -R "survival"` and tighten their analytic assertions so we catch regressions in the existing Weibull/Exponential/Lognormal/Loglogistic paths. (2025-12-01)
- [x] Build ergonomic Python and R front-end APIs that translate user formulas/arguments into the shared IR, keeping bindings thin (blueprint §§8–10). Tests: `PYTHONPATH=build uv run pytest python/semx/tests -k "api"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`, `ctest --test-dir build -R "likelihood_driver"`. (2025-12-01)
	- [x] Introduce `semx.Model` (Python) and matching R S3 constructor that accept formula-style specs, random-effect declarations, and covariance definitions, then emit IR for C++ (2025-12-15).
	- [x] Add integration tests proving Python/R front-ends round-trip the existing Laplace, Kronecker, and survival fixtures through the bindings.
	- [x] Update documentation/examples to walk through the new APIs and ensure CI instructions reference the front-end tests (python/README.md, docs/examples/formula_frontend.md). (2025-12-15)
		- Front-end parser tests: `PYTHONPATH=build uv run pytest python/semx/tests -k model_api`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat', filter = 'bindings')"` (2025-12-15)

## Phase 3: Advanced Features

- [x] Implement Multi-group Analysis (blueprint §2.7).
    - [x] Implement `MultiGroupModelObjective` in C++ core.
    - [x] Add `fit_multi_group` to `LikelihoodDriver` and expose to bindings.
    - [x] Add C++ tests for multi-group likelihood and gradients.
    - [x] Add Python bindings for `fit_multi_group`.
    - [x] Add R bindings for `fit_multi_group`.
    - [x] Add Python/R tests for multi-group analysis.
