# libsemx TODO

## Active
- [x] Extend SEM branch to honor full structural model. (2025-12-02)
    - [x] Propagate regression edges into `_stacked_y` predictors.
    - [x] Carry intercepts/means.
    - [x] Map cross-latent and residual covariances (Latents grouped with Unstructured covariance).
- [x] Implement dispersion/threshold parameter handling for non-Gaussian GLMMs. (2025-12-02)
    - [x] Expose parameters in catalog.
    - [x] Implement gradients.
- [x] Plumb `EstimationMethod` (ML/REML) through `ModelObjective`. (2025-12-02)
    - [x] Updated `ModelObjective` and `LikelihoodDriver::fit` to accept `EstimationMethod`.
    - [x] Implemented REML logic for Gaussian fixed-effects models in `LikelihoodDriver`.
    - [x] Verified with `reml_plumbing_tests.cpp`.
- [x] Harden Laplace solver (damping, line search, diagnostics). (2025-12-02)
    - [x] Implemented backtracking line search in `solve_laplace_system`.
    - [x] Added Cholesky damping to handle non-positive definite Hessians.
- [x] Polish Python/R `summary()`/`predict()`/`plot()` surfaces. (2025-12-02)
    - [x] Updated Python `SemFit.summary()` to return structured `SemFitSummary` object.
    - [x] Enhanced Python `SemFit.plot()` with `ax` support and Q-Q plots.
    - [x] Improved R `summary.semx_fit` to return list with fit indices and parameter table.
    - [x] Updated R `plot.semx_fit` to accept additional arguments.
- [x] Add identifiability checks/constraints for composed covariances (Kronecker scaling, Hadamard or weighted sums with weights summing to 1). (2025-12-02)
    - [x] Implemented analytic gradients for `KroneckerCovariance` with `learn_scale=true`.
    - [x] Added `simplex_weights` mode to `MultiKernelCovariance` with softmax transform and gradients.
- [x] Align front-end APIs with the richer DSL/plotting guidelines and design identifiability checks plus summary reporting plan. (2025-02-24)
    - [x] Updated `Model` (Python) to support `multi_kernel_simplex` and list of marker matrices.
    - [x] Updated `SemFitSummary` (Python) to display covariance weights and use parameter names from C++.
    - [x] Fixed C++ `build_covariance_positive_mask` for `multi_kernel_simplex`.
    - [x] Exposed `parameter_names` in `FitResult` via bindings.
- [x] Extend optimizers and fit indices. (2025-02-24)
    - [x] Implement CFI, TLI, RMSEA, and SRMR fit indices in C++ and expose to bindings. (2025-02-24)
    - [x] Add variance component extraction methods. (2025-02-24)
    - [x] Explore/expose additional optimizer settings (e.g., line search parameters). (2025-02-24)
- [x] Enrich ModelIR to carry extra schema. (2025-02-24)
    - [x] Extend `ModelIR` to store variable labels, measurement levels, and other metadata.
    - [x] Ensure this metadata is preserved through the bindings and available in `summary()`.

## Completed
- [x] Support precomputed covariance matrices in Python and R front-ends. (2025-02-24)
    - [x] Updated `semx.Model` (Python) to accept `data` in genomic specs.
    - [x] Updated `semx_model` (R) to accept `data` in genomic specs.
    - [x] Updated MDP analysis notebooks to demonstrate usage.
- [x] Add higher-level GS/trait×env builders. (2025-02-24)
    - [x] Create easy-to-use builders for G×E models (e.g., `semx.gxe_model(...)`).
    - [x] Support multi-environment trial (MET) data structures.
- [x] Wire survival status through R fit and add CIF/survival prediction helpers. (2025-12-02)
    - [x] Update R `semx_fit` to handle `Surv()` objects or status columns.
    - [x] Implement `predict_survival()` and `predict_cif()` helpers in R and Python.
- [x] Flesh out R/Python public methods to match blueprint surface. (2025-12-02)
    - [x] Implement `summary()`, `predict()`, and `plot()` methods in Python (`semx.Model`) and R (`semx_model`).
    - [x] Add Genomic Selection (GS) utilities (e.g., cross-validation helpers, heritability extraction).
- [x] Implement Mixed Model syntax parser in R front-end. (2025-02-24)
    - [x] Support `(1 | group)` and `(slope | group)` syntax in equations.
    - [x] Map these expressions to `ModelIR` random effects structure.
    - [x] Ensure parity with Python implementation.
- [x] Implement Mixed Model syntax parser in Python front-end. (2025-02-24)
    - [x] Support `(1 | group)` and `(slope | group)` syntax in equations.
    - [x] Map these expressions to `ModelIR` random effects structure.
    - [x] Automatically inject `_intercept` column for random slopes with intercept.
- [x] Implement Survival Analysis syntax in Python front-end. (2025-02-24)
    - [x] Support `Surv(time, status) ~ predictors` syntax in `python/semx/model.py`.
    - [x] Automatically register `status` variable and map to `LikelihoodDriver` inputs.
    - [x] Ensure `OutcomeFamily` is correctly set (Weibull, Exponential, etc.) via user input and C++ plumbing.
- [x] Implement analytic gradients for residual variances in SEM mode. (2025-02-24)
    - [x] Extended `LikelihoodDriver` to compute gradients w.r.t. dispersions using `dispersion_param_mappings`.
    - [x] Updated `ModelObjective` to use analytic gradients for residual variances, removing the finite difference fallback.
    - [x] Verified with `cpp/tests/sem_gradient_tests.cpp`.
- [x] Optimize SEM gradients (Analytic Gradients for Loadings). (2025-02-24)
    - [x] Implemented `evaluate_model_gradient` support for `data_param_mappings` to compute gradients w.r.t. design matrix $Z$.
    - [x] Updated `ModelObjective` to use analytic gradients for loadings and covariance parameters.
    - [x] Verified with `cpp/tests/sem_gradient_tests.cpp` matching FD gradients.
- [x] Expose post-estimation diagnostics to R bindings. (2025-02-24)
    - [x] Added R bindings for `compute_standardized_estimates`, `compute_model_diagnostics`, `compute_modification_indices`.
    - [x] Updated `semx_model` (R) to provide methods/accessors for these diagnostics.
    - [x] Fixed `compute_modification_indices` to include diagonal elements (variances) as candidates.
- [x] Fix LikelihoodDriver for SEM estimation (Latent Variables). (2025-02-24)
- [x] Build genomic kernel stack and GRM ingestion (blueprint §§3.4–5).
    - [x] Add `GenomicRelationshipMatrix` (VanRaden) builder plus Kronecker helper for G×E kernels.
    - [x] Wire GRM/`genomic` covariance structure through the factory with positive masks.
    - [x] Add C++ tests covering GRM construction and GRM-powered likelihood evaluation.
    - [x] Extend ModelIR/bindings to ingest marker payloads directly.
    - [x] Add Python/R surfacing for genomic kernels and multi-environment fixtures.

## Completed
- [x] Fix LikelihoodDriver for SEM estimation (Latent Variables). (2025-02-24)
    - [x] Modified `ModelObjective` to handle "SEM mode" by stacking data and dynamically updating design matrices with Loading parameters.
    - [x] Verified with `python/semx/tests/test_sem_estimation.py` (Loadings are now estimated correctly).
- [x] Expose post-estimation diagnostics to Python bindings. (2025-02-24)
    - [x] Add Python bindings for `compute_standardized_estimates`, `compute_model_diagnostics`, `compute_modification_indices`.
    - [x] Update `semx.Model` (Python) to provide methods/accessors for these diagnostics.
- [x] Implement post-estimation diagnostics (blueprint §2.8). (2025-02-24)
	- [x] Implement standardized parameter estimates (std.lv, std.all). (2025-02-24)
	- [x] Implement model-implied covariance/means and residuals. (2025-02-24)
	- [x] Implement modification indices (approximate via gradients). (2025-02-24)
- [x] Refactor LikelihoodDriver to decouple ModelObjective and Covariance Factory. (2025-02-24)
	- [x] Extract `ModelObjective` class to `cpp/src/libsemx/model_objective.cpp` and `cpp/include/libsemx/model_objective.hpp`.
	- [x] Move covariance factory logic (`create_covariance_structure`, `build_covariance_positive_mask`) to `cpp/src/libsemx/covariance_structure.cpp`.
	- [x] Clean up `LikelihoodDriver` to remove duplicate code and unused constants.
- [x] Implement non-Gaussian outcome families (blueprint §2.4). (2025-12-12)
	- [x] Add `BinomialOutcome` (logit/probit), `PoissonOutcome`, `NegativeBinomialOutcome`.
	- [x] Implement Laplace approximation for these families in `LikelihoodDriver`.
	- [x] Add tests for GLMM scenarios.
- [x] Implement Full Information Maximum Likelihood (FIML) for missing data (blueprint §2.6). (2025-12-12)
	- [x] Update `LikelihoodDriver` to handle `NaN` in observed data by filtering indices per row/cluster.
	- [x] Ensure `OutcomeFamily` subclasses handle missingness correctly (usually by just skipping the contribution).
	- [x] Add tests with missing data patterns.
- [x] Implement standard errors and fit statistics for model parameters (blueprint §2.8). (2025-12-12)
	- [x] Add `FitResult` struct to C++ core (replacing or extending `OptimizationResult`) containing parameter estimates, SEs, vcov matrix, and fit indices (AIC, BIC).
	- [x] Implement numerical Hessian computation (finite differences) for the marginal log-likelihood in `LikelihoodDriver` as a post-fit step.
	- [x] Expose `FitResult` to Python and R bindings.
	- [x] Update Python `semx.Model.fit()` and R `semx_model` to return/print summary with SEs and p-values.
	- [x] Add integration tests verifying SEs against known results (e.g., `lme4` or `lavaan` benchmarks).
- [x] Extend ModelGraph + IR parameter registry so structural equations, constraints, and parameter metadata match blueprint §§2.2–3.2. Tests: `ctest --test-dir build -R "model_graph"`, `ctest --test-dir build -R "likelihood_driver"`, `PYTHONPATH=build uv run pytest python/semx/tests -k "model_graph or fit"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Introduce a central parameter catalog that maps edge IDs and covariance specs to `Parameter` objects plus transforms, then thread it through `LikelihoodDriver::fit`.
	- [x] Restore the default identity design fallback for scaled-fixed random effects so the GRM/fixed covariance fixtures keep passing after the catalog refactor. (2025-12-01)
	- [x] Expand `ModelGraph` to store regressions/loadings/covariances directly and serialize them into ModelIR so bindings share one source of truth (parameter specs recorded with constraint metadata surfaced through Python/R bindings). (2025-12-12)
	- [x] Add Catch2 + Python/R tests exercising duplicate detection, parameter ordering, and gradient alignment once the registry is in place. (2025-12-01)
		- [x] Cover ModelGraph duplicate/family validation through `python/semx/tests/test_model_graph.py` so bindings mirror the C++ exceptions. (2025-12-11)
		- [x] Mirror ModelGraph edge/covariance/random-effect serialization plus validation via `python/semx/tests/test_model_graph.py` and `python/semx/tests/test_model_ir.py`. (2025-12-11)
		- [x] Add `testthat` coverage for ModelIRBuilder invariants (duplicates, families, edge/covariance/random-effect checks) in `Rpkg/semx/tests/testthat/test-bindings.R`. (2025-12-11)
		- [x] Extend Catch2 `cpp/tests/model_graph_tests.cpp` with empty-graph, covariance, and edge/random-effect validation cases to keep the core aligned with the bindings. (2025-12-11)
		- [x] Assert deterministic parameter ordering/constraints across C++/Python/R (new Catch2 tests plus `test_model_graph.py` and `test-bindings.R`), and fix the REML adjustment sign in `LikelihoodDriver` while wiring the catalog to the serialized specs. (2025-12-12)
- [x] Broaden the covariance catalog with compound symmetry, AR(1), Toeplitz, and factor-analytic structures per blueprint §3.3, each with analytic gradients. Tests: `ctest --test-dir build -R "covariance"`, `ctest --test-dir build -R "laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k "covariance"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Implement the new covariance classes plus factory wiring and gradient hooks, preserving positive-definite parameterizations.
	- [x] Add finite-difference gradient probes in Catch2 along with Laplace fit scenarios that mix the new structures with existing ones.
	- [x] Mirror the fixtures via Python/R tests that serialize IR payloads using the new covariance identifiers.
- [x] Complete the survival and competing-risks stack by adding exponential, lognormal, and loglogistic AFT outcomes plus CIF-aware cause-specific families (blueprint §7). Tests: `ctest --test-dir build -R "survival"`, `PYTHONPATH=build uv run pytest python/semx/tests -k "survival"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Implement the additional outcome families with analytic derivatives and shared dispersion handling (shared-dispersion broadcast wired through LikelihoodDriver helpers).
	- [x] Extend `LikelihoodDriver::evaluate_model_loglik_full` scenarios (C++/Python/R) to cover censored data and CIF calculations; add analytic helper assertions plus R bindings tests mirroring the C++/Python fixtures. (2025-12-01)
	- [x] Document the new families in README/examples and add deterministic fixtures for multi-cause survival payloads (`python/README.md`, `docs/examples/survival_cif.md`). (2025-12-01)
	- [x] Ensure the survival unit/integration tests participate in `ctest -R "survival"` and tighten their analytic assertions so we catch regressions in the existing Weibull/Exponential/Lognormal/Loglogistic paths. (2025-12-01)
- [x] Build ergonomic Python and R front-end APIs that translate user formulas/arguments into the shared IR, keeping bindings thin (blueprint §§8–10). Tests: `PYTHONPATH=build uv run pytest python/semx/tests -k "api"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`, `ctest --test-dir build -R "likelihood_driver"`. (2025-12-01)
	- [x] Introduce `semx.Model` (Python) and matching R S3 constructor that accept formula-style specs, random-effect declarations, and covariance definitions, then emit IR for C++ (2025-12-15).
	- [x] Add integration tests proving Python/R front-ends round-trip the existing Laplace, Kronecker, and survival fixtures through the bindings.
	- [x] Update documentation/examples to walk through the new APIs and ensure CI instructions reference the front-end tests (python/README.md, docs/examples/formula_frontend.md). (2025-12-15)
		- Front-end parser tests: `PYTHONPATH=build uv run pytest python/semx/tests -k model_api`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat', filter = 'bindings')"` (2025-12-15)
- [x] Validate Ordinal (probit) Laplace gradients with threshold transforms so categorical families stay aligned with blueprint §§3.6 & 6.2. Tests: `ctest --test-dir build -R "Laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k "laplace_gradient"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Add a Catch2 finite-difference probe for an ordinal mixed model (3-category probit with random intercept) to guard the C++ core. (2025-12-01)
	- [x] Mirror the ordinal gradient check through Python bindings with the same IR payload and finite differences. (2025-12-01)
	- [x] Mirror the scenario in the R bindings via `evaluate_model_loglik_full` to keep front-ends consistent. (2025-12-01)
- [x] Validate Negative Binomial Laplace gradients with random intercepts so non-Gaussian families beyond binomial stay covered; leverage blueprint §§3.6 & 6.3 for derivative expectations. Tests: `ctest --test-dir build -R "Laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k "laplace_gradient"`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Add a Catch2 finite-difference gradient probe for a negative-binomial mixed model (random intercept) to guard the C++ core. (2025-12-01)
	- [x] Mirror the negative-binomial gradient check through Python bindings (reusing the shared IR) with finite differences. (2025-12-01)
	- [x] Mirror the scenario in the R bindings via `evaluate_model_loglik_full` to keep all front-ends aligned. (2025-12-01)
- [x] Validate Kronecker Laplace gradients against finite differences so the new fixtures catch future regressions; extend blueprint §7.2 references into numerical harnesses. Tests: `ctest --test-dir build -R "Kronecker"`, `PYTHONPATH=build uv run pytest python/semx/tests -k kronecker`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Add a Catch2 finite-difference probe (beta plus kernel weights) for the Kronecker+diagonal model to quantify gradient error tolerances. (2025-12-01)
	- [x] Mirror the numeric check through Python and R smoke tests (e.g., compare analytic gradients to autograd/finite diff utilities) to keep bindings in lockstep. (2025-12-01)

- [x] Validate Laplace `fit()` with correlated random slopes (unstructured q=2) so we cover off-diagonal covariance gradients; extend Catch2/Python/R fixtures accordingly per blueprint §3.3. Tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "Laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k laplace`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-01)
	- [x] Add a Catch2 scenario that uses an unstructured 2×2 covariance for the intercept+slope random effect and asserts the optimizer reports both variances plus covariance. (2025-12-01)
	- [x] Mirror the same correlated random-slope payload via Python/R Laplace fit tests so bindings stay aligned on parameter ordering. (2025-12-01)

- [x] Stress Laplace `fit()` with Kronecker + diagonal covariance stacks so multi-kernel parameter transforms stay stable; implement Catch2/Python/R fixtures per blueprint §§3.3 & 7.2. Tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "Laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k laplace`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-05)
	- [x] Re-read blueprint §§3.3 & 7.2 to lock down Kronecker kernel layout plus gradient expectations, then sketch the shared IR payload (traits × environments with diagonal noise). (2025-12-05)
	- [x] Add a Catch2 Laplace scenario combining a Kronecker covariance with a diagonal effect and assert gradients for all kernel weights. (2025-12-05)
	- [x] Mirror the Kronecker Laplace fit via Python and R bindings, keeping IR payloads identical to the C++ fixture and passing in fixed kernels via bindings. (2025-12-05)

- [x] Cover Laplace `fit()` with random-slope effects (q>1) so block Hessians and parameter transforms stay stable; reuse the binomial GLMM payload but add slope columns per blueprint §3.2. Tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "Laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k laplace`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-04)
	- [x] Extend the Catch2 Laplace fixture to include a random effect with intercept+slope (dimension two) under a diagonal covariance and assert q>1 gradients. (2025-12-04)
	- [x] Mirror the same IR payload through Python and R fit tests so bindings hit the same q>1 Laplace code paths. (2025-12-04)

- [x] Stress-test Laplace `fit()` with mixed covariance types (diagonal + scaled-fixed) so stacked transforms stay stable; extend Catch2/Python/R fixtures accordingly. Tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "Laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k laplace`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-04)
	- [x] Add a Catch2 scenario mixing diagonal and scaled fixed covariances (two random effects) and assert Laplace fit convergence. (2025-12-04)
	- [x] Mirror the same heteroskedastic random-effects payload through Python/R tests to guard binding parity. (2025-12-04)

- [x] Broaden Laplace `fit()` coverage to multi-effect binomial models so the optimizer handles stacked covariance parameters; ensure ModelObjective exposes the requisite transforms through bindings. Tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "Laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k laplace`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-04)
	- [x] Extend the Catch2 Laplace fit fixture to include two random effects with distinct covariance structures and assert optimizer stability. (2025-12-04)
	- [x] Add mirrored Python/R integration tests that serialize the same IR payload so we catch any binding drift for stacked Laplace parameters. (2025-12-04)

- [x] Enable Laplace-aware `fit()` flows so ModelObjective can optimize binomial mixed models end-to-end with analytic gradients; tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "Laplace"`, `PYTHONPATH=build uv run pytest python/semx/tests -k laplace`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"`. (2025-12-04)
	- [x] Add a Catch2 integration test that runs `LikelihoodDriver::fit` on a Laplace (binomial) mixed model and confirms convergence with analytic gradients. (2025-12-04)
	- [x] Mirror the same scenario via Python and R fit tests to ensure the IR/optimizer stack stays synchronized across front-ends. (2025-12-04)

- [x] Extend mixed-model analytic gradients to non-Gaussian (Laplace) families and validate against finite differences across multiple random-effect structures. (2025-12-03)
	- [x] Derive and implement analytic gradients for single-effect Laplace models (reference blueprint §6.3) reusing the Newton-mode Hessian; tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "Laplace gradients"` (2025-12-01).
	- [x] Generalize the Laplace gradient path to multiple random effects by assembling block-aware Hessians and validating blockwise traces; tests: `ctest --test-dir build -R "Laplace"` (2025-12-02).
	- [x] Expose Laplace gradients through ModelObjective/Python bindings and add IR-driven integration tests mirroring the Gaussian suite; tests: `PYTHONPATH=build uv run pytest python/semx/tests -k laplace`, `uv run R -q -e "testthat::test_dir('Rpkg/semx/tests/testthat')"` (2025-12-03).
- [x] Generalize Gaussian mixed-model likelihood/gradient assembly to handle multiple grouping factors via full V construction. Tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "analytic gradients"`. (2025-12-01)
- [x] Implement analytic gradients for mixed models (multiple Gaussian random effects per grouping). Tests: `cmake --build build --target libsemx_tests`, `ctest --test-dir build -R "analytic gradients"`. (2025-12-02)
- [x] Expose fixed covariance data in LikelihoodDriver::fit and bindings. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build -R "fixed covariance"`. (2025-12-01)
- [x] Extend ModelObjective to include covariance parameters in optimization. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build -R libsemx_tests`. (2025-12-01)
- [x] Implement analytic gradients for ModelObjective to replace finite differences (for fixed effects). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build -R libsemx_tests`. (2025-12-01)
- [x] Integrate LBFGS optimizer into LikelihoodDriver and expose to bindings. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build -R LikelihoodDriver`, `PYTHONPATH=build uv run pytest python/semx/tests/test_fit.py`. (2025-12-01)
- [x] Implement Multi-Kernel covariance structure with weighted sum of kernels. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Genomic Relationship Matrix (GRM) kernel support. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement L-BFGS optimizer wrapper (using LBFGS++ or similar). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build -R LBFGSOptimizer`. (2025-12-01)
- [x] Implement R bindings for ModelIR and LikelihoodDriver. Tests: `R CMD INSTALL ../Rpkg/semx && R -q -e "library(testthat); library(semx); test_dir('../Rpkg/semx/tests/testthat')"`. (2025-12-01)
- [x] Implement Python bindings for ModelIR and LikelihoodDriver. Tests: `cmake -S cpp -B build`, `cmake --build build`, `PYTHONPATH=build uv run pytest python/semx/tests`. (2025-12-01)
- [x] Implement Kronecker product covariance structure for GxE models (N-way, identification handling). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Laplace approximation for non-Gaussian random effects. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement REML for Gaussian random effects. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Ordinal outcome family (Probit link with thresholds). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Competing Risks support (Cause-specific hazards via censoring). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Survival outcome families (Weibull) with censoring support. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Gaussian ML random effects evaluation (intercepts and slopes) with covariance structures. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Bootstrap core scaffolding: CMake project, ModelGraph skeleton, Parameter primitive, and Catch2-based test harness (reference §§2.2, 3.1, 3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Flesh out parameter transforms for constrained optimization and integrate with `Parameter` unconstrained storage (reference §3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement covariance structure base class with unstructured and diagonal variants (reference §3.3). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Introduce Gaussian outcome family with log-likelihood and gradient hooks (reference §3.6 & §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Design frontend IR contract for Python and R bindings (reference §2.1 and §10). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Outline optimizer plug-in interface (reference §2.7 and §3.8). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate Gaussian outcome evaluation into preliminary likelihood driver stub (reference §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Draft Python package test harness scaffolding mirroring C++ fixtures (reference mission snapshot). Tests: `cd python && uv run pytest`. (2025-12-01)
- [x] Extend LikelihoodDriver to support mixed outcome families and integrate with ModelIR for end-to-end evaluation. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement additional outcome families (Negative Binomial, Binomial) and extend factory. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement analytic derivatives for Negative Binomial outcome family. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate random effects and covariance structures into LikelihoodDriver for full mixed-model evaluation (stub: throws on random effects). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)

- [x] Implement Kronecker product covariance structure for GxE models (N-way, identification handling). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Laplace approximation for non-Gaussian random effects. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement REML for Gaussian random effects. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Ordinal outcome family (Probit link with thresholds). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Competing Risks support (Cause-specific hazards via censoring). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Survival outcome families (Weibull) with censoring support. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement Gaussian ML random effects evaluation (intercepts and slopes) with covariance structures. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Bootstrap core scaffolding: CMake project, ModelGraph skeleton, Parameter primitive, and Catch2-based test harness (reference §§2.2, 3.1, 3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Flesh out parameter transforms for constrained optimization and integrate with `Parameter` unconstrained storage (reference §3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement covariance structure base class with unstructured and diagonal variants (reference §3.3). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Introduce Gaussian outcome family with log-likelihood and gradient hooks (reference §3.6 & §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Design frontend IR contract for Python and R bindings (reference §2.1 and §10). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Outline optimizer plug-in interface (reference §2.7 and §3.8). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate Gaussian outcome evaluation into preliminary likelihood driver stub (reference §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Draft Python package test harness scaffolding mirroring C++ fixtures (reference mission snapshot). Tests: `cd python && uv run pytest`. (2025-12-01)
- [x] Extend LikelihoodDriver to support mixed outcome families and integrate with ModelIR for end-to-end evaluation. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement additional outcome families (Negative Binomial, Binomial) and extend factory. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement analytic derivatives for Negative Binomial outcome family. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate random effects and covariance structures into LikelihoodDriver for full mixed-model evaluation (stub: throws on random effects). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Bootstrap core scaffolding: CMake project, ModelGraph skeleton, Parameter primitive, and Catch2-based test harness (reference §§2.2, 3.1, 3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Flesh out parameter transforms for constrained optimization and integrate with `Parameter` unconstrained storage (reference §3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement covariance structure base class with unstructured and diagonal variants (reference §3.3). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Introduce Gaussian outcome family with log-likelihood and gradient hooks (reference §3.6 & §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Design frontend IR contract for Python and R bindings (reference §2.1 and §10). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Outline optimizer plug-in interface (reference §2.7 and §3.8). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate Gaussian outcome evaluation into preliminary likelihood driver stub (reference §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Draft Python package test harness scaffolding mirroring C++ fixtures (reference mission snapshot). Tests: `cd python && uv run pytest`. (2025-12-01)
- [x] Extend LikelihoodDriver to support mixed outcome families and integrate with ModelIR for end-to-end evaluation. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement additional outcome families (Negative Binomial, Binomial) and extend factory. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement analytic derivatives for Negative Binomial outcome family. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Bootstrap core scaffolding: CMake project, ModelGraph skeleton, Parameter primitive, and Catch2-based test harness (reference §§2.2, 3.1, 3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Flesh out parameter transforms for constrained optimization and integrate with `Parameter` unconstrained storage (reference §3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement covariance structure base class with unstructured and diagonal variants (reference §3.3). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Introduce Gaussian outcome family with log-likelihood and gradient hooks (reference §3.6 & §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Design frontend IR contract for Python and R bindings (reference §2.1 and §10). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Outline optimizer plug-in interface (reference §2.7 and §3.8). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate Gaussian outcome evaluation into preliminary likelihood driver stub (reference §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Draft Python package test harness scaffolding mirroring C++ fixtures (reference mission snapshot). Tests: `cd python && uv run pytest`. (2025-12-01)
- [x] Extend LikelihoodDriver to support mixed outcome families and integrate with ModelIR for end-to-end evaluation. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement additional outcome families (Negative Binomial, Binomial) and extend factory. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Bootstrap core scaffolding: CMake project, ModelGraph skeleton, Parameter primitive, and Catch2-based test harness (reference §§2.2, 3.1, 3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Flesh out parameter transforms for constrained optimization and integrate with `Parameter` unconstrained storage (reference §3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement covariance structure base class with unstructured and diagonal variants (reference §3.3). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Introduce Gaussian outcome family with log-likelihood and gradient hooks (reference §3.6 & §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Design frontend IR contract for Python and R bindings (reference §2.1 and §10). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Outline optimizer plug-in interface (reference §2.7 and §3.8). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate Gaussian outcome evaluation into preliminary likelihood driver stub (reference §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Draft Python package test harness scaffolding mirroring C++ fixtures (reference mission snapshot). Tests: `cd python && uv run pytest`. (2025-12-01)
- [x] Extend LikelihoodDriver to support mixed outcome families and integrate with ModelIR for end-to-end evaluation. Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Bootstrap core scaffolding: CMake project, ModelGraph skeleton, Parameter primitive, and Catch2-based test harness (reference §§2.2, 3.1, 3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Flesh out parameter transforms for constrained optimization and integrate with `Parameter` unconstrained storage (reference §3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement covariance structure base class with unstructured and diagonal variants (reference §3.3). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Introduce Gaussian outcome family with log-likelihood and gradient hooks (reference §3.6 & §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Design frontend IR contract for Python and R bindings (reference §2.1 and §10). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Outline optimizer plug-in interface (reference §2.7 and §3.8). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate Gaussian outcome evaluation into preliminary likelihood driver stub (reference §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Draft Python package test harness scaffolding mirroring C++ fixtures (reference mission snapshot). Tests: `cd python && uv run pytest`. (2025-12-01)
- [x] Bootstrap core scaffolding: CMake project, ModelGraph skeleton, Parameter primitive, and Catch2-based test harness (reference §§2.2, 3.1, 3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Flesh out parameter transforms for constrained optimization and integrate with `Parameter` unconstrained storage (reference §3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement covariance structure base class with unstructured and diagonal variants (reference §3.3). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Introduce Gaussian outcome family with log-likelihood and gradient hooks (reference §3.6 & §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Design frontend IR contract for Python and R bindings (reference §2.1 and §10). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Outline optimizer plug-in interface (reference §2.7 and §3.8). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Integrate Gaussian outcome evaluation into preliminary likelihood driver stub (reference §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Bootstrap core scaffolding: CMake project, ModelGraph skeleton, Parameter primitive, and Catch2-based test harness (reference §§2.2, 3.1, 3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Flesh out parameter transforms for constrained optimization and integrate with `Parameter` unconstrained storage (reference §3.2). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Implement covariance structure base class with unstructured and diagonal variants (reference §3.3). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Introduce Gaussian outcome family with log-likelihood and gradient hooks (reference §3.6 & §6.1). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Design frontend IR contract for Python and R bindings (reference §2.1 and §10). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
- [x] Outline optimizer plug-in interface (reference §2.7 and §3.8). Tests: `cmake -S cpp -B build`, `cmake --build build`, `ctest --test-dir build`. (2025-12-01)
